zos-academy.fr {
	@public path / /api/*
	handle @public {
		reverse_proxy auth:8081
	}

	@labs path /labs/*
	handle @labs {
		reverse_proxy auth:8081 {
			uri /api/verify
			header_up Cookie {http.request.header.Cookie}
			handle_response {
				@unauth status 401 403
				handle @unauth { redir / 302 }
			}
		}

		reverse_proxy navigateur:80
	}

	encode gzip
}

www.zos-academy.fr {
	redir https://zos-academy.fr{uri} permanent
}
